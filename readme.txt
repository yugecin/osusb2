Note: (most of) the code is horrible times 20 and disgusting times 30.
It's not meant to be reused (although I said the same last time and I copied
that to make this, go figure) and I just wanted this done with.
